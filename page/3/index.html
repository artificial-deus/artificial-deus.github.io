<!DOCTYPE html><html lang="cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Akachi's blog</title><meta name="author" content="Akachi"><meta name="copyright" content="Akachi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="Akachi&#39;s blog">
<meta property="og:url" content="https://artificial-deus.github.io/page/3/index.html">
<meta property="og:site_name" content="Akachi&#39;s blog">
<meta property="og:locale">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/38939292?s=60&v=4">
<meta property="article:author" content="Akachi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/38939292?s=60&v=4"><link rel="shortcut icon" href="https://raw.githubusercontent.com/akachi10/notes/master/god_dice.jfif"><link rel="canonical" href="https://artificial-deus.github.io/page/3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?a04e00a053a6685b9b86ca842f0f2e2f";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BGTJN89SV4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BGTJN89SV4');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"FCSTQQ895M","apiKey":"72acbaa4c88844d34550b999e19531f0","indexName":"blog-search","hits":{"per_page":6},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Akachi\'s blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-11-29 00:35:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/38939292?s=60&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">52</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">28</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 档案</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 类别</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://raw.githubusercontent.com/akachi10/blog-pic/main/1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Akachi's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 档案</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 类别</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Akachi's blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/akachi10" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zsts@hotmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2019/02/28/docker/docker%20%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%20/" title="Docker镜像仓库">Docker镜像仓库</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-03-01T07:00:42.000Z" title="Created 2019-02-28 23:00:42">2019-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Docker/">Docker</a></span></div><div class="content">Docker镜像仓库
创建密码
12mkdir authdocker run --entrypoint htpasswd httpd:2 -Bbn akachi TS8495877 &gt; auth/htpasswd


可能遇得到httpd:2下载不到的问题
参考以下解决问题
123456789101112# 1、阿里云docker加速器配置文件sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;&#123;&quot;registry-mirrors&quot;: [&quot;https://s796m7v3.mirror.aliyuncs.com&quot;]&#125;EOFsudo systemctl daemon-reloadsudo systemctl restart docker

docker-compose.yml
123456789101112131415161718services:  registry:    image: registry:2. ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2019/02/28/Spring/Spring%20Cloud%20Sleuth+Zipkin-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Cloud Sleuth+Zipkin-学习笔记">Spring Cloud Sleuth+Zipkin-学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-02-28T15:00:42.000Z" title="Created 2019-02-28 07:00:42">2019-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/sleuth/">sleuth</a></span></div><div class="content">Spring Cloud Sleuth+Zipkin-学习笔记
参考文档
Sentinel :https://sentinelguard.io/zh-cn/docs/quick-start.html

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2018/02/28/Spring/Spring%20Cloud%20Gateway-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Cloud Gateway-学习笔记">Spring Cloud Gateway-学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2018-02-28T15:00:42.000Z" title="Created 2018-02-28 07:00:42">2018-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/gateway/">gateway</a></span></div><div class="content">Spring Cloud Gateway
使用SpringBoot2 开发的基于Spring Framework 5开发的Gateway框架，用于替代 Netflix zuul

介绍
网关的功能
让客户端只需要访问一个服务地址
保护网内的服务调用安全
实现了 监控、弹性和安全性的路由
过滤器完成以下功能
身份认证与安全
审查监控
动态路由
压力测试
负载分配
静态响应处理
多区域弹性



概念
路由 (routes)

id 路由的唯一标识


断言 (predicates)
什么样的规则进入匹配进一个路由
路由的入口规则

例
Path=/order-server/**


过滤器 (filters)
改变请求的URL和参数使之匹配为真实访问的地址

例:
StripPrefix=1



参考资料
https://mrhelloworld.com/
https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2018/02/28/Spring/Spring%20Cloud%20Zuul-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Cloud Zuul-学习笔记">Spring Cloud Zuul-学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2018-02-28T15:00:42.000Z" title="Created 2018-02-28 07:00:42">2018-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/zuul/">zuul</a></span></div><div class="content">Spring Cloud Zuul
使用SpringBoot2 开发的基于Spring Framework 5开发的Gateway框架，用于替代 Netflix zuul

介绍
网关的功能
让客户端只需要访问一个服务地址

保护网内的服务调用安全

实现了 监控、弹性和安全性的路由

过滤器完成以下功能

跨域问题
只要访问网关就能解决跨域问题

身份认证与安全 

审查监控

动态路由

压力测试

负载分配

静态响应处理

多区域弹性




实现方案
Nginx + Lua
Kong
Traefik
Spring Cloud Netflix Zuul
Spring Cloud Gateway

网关的工作方式
搭建方式创建一个注册中心创建一个Product创建一个Order 用Feing搭建一个nginx 负载均衡到多个Gateway使用zuul
manven中引入 org.springframework.cloud spring-cloud-starter-netflix-zuul包

application.yml
1234zuul: ignoredServices: & ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2018/02/28/Spring/Spring%20Cloud%20Sentinel-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.md/" title="Spring Cloud Gateway-学习笔记">Spring Cloud Gateway-学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2018-02-28T15:00:42.000Z" title="Created 2018-02-28 07:00:42">2018-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/sentinel/">sentinel</a></span></div><div class="content">Spring Cloud Sentinel-学习笔记.md
介绍Sentinel是Hystrix的替代谢解决方案
官网：https://sentinelguard.io/zh-cn/
Github: https://github.com/alibaba/Sentinel


支持双十一10年
完备的实时监控
比hystrix好用


总体框架如下

Sentinel分为两个部分

核心库(java控制端)
控制台(Dashboard) 基于Spring Boot开发，打开后可直接运行

搭建控制台下载控制台:https://sentinelguard.io/zh-cn/docs/dashboard.html
​                    https://github.com/alibaba/Sentinel/tree/master/sentinel-dashboard4

下载sentinel

E:\DBank\软件\开发软件\sentinel

启动命令
1java -Dserver.port=18558 -Dcsp.sentinel.dashboard.server= ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2017/08/01/Spring/Spring%20AOP/" title="Spring AOP">Spring AOP</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-08-01T15:00:42.000Z" title="Created 2017-08-01 08:00:42">2017-08-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/spring/">spring</a></span></div><div class="content">Spring AOP主要概念
aspect(切面) 由通知、切点、组成，是个逻辑概念可以理解为以下概念的集合

pointcut(切点) 每个类都拥有多个连接点，可以理解为连接点的集合。

joinpoint(连接点)，程序执行的特定位置，如某个方法调用等

weaving(织入) 将通知(advice)连接到具体连接点的过程

advice(通知) 是植入到目标类连接点商店一段代码。
通知种类
Before advice 前置通知 无论方法是否异常都会执行,因为是先执行的

After returning  advice 后置通知

after throwing advice 异常通知

after finally advice 最终通知 无论目标方法是否异常都会执行

Around advice 环绕通知
通过调用ProceedingJoinPoint.proceed()可以在目标执行全过程中执行。



target: 目标对象

aop Proxy: 产生的代理新对象


Spring AOP 底层实现，是通过JDK动态代理或CGLib代理在运行实际在对象初始化阶段织入代码的。 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2017/02/28/Spring/Spring%20Security-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Security-学习笔记">Spring Security-学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-03-01T07:00:42.000Z" title="Created 2017-02-28 23:00:42">2017-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Security/">Security</a></span></div><div class="content">Spring Security原理
Spring Security 原理上来说是一个过滤器链。
以下列出过滤器链中关键的部分。

UsernamePasswordAuthenticationFilter
用户名密码认证过滤器

ExceptionTranslationFilter
异常转换过滤器

FilterSecurityInterceptor
过滤器安全拦截器，负责授权的


最后再进入原定的API


默认的过滤器链

其中DefaultLoginPage…、DefaultLogoutPage…风别是默认登录与默认登出页面。

查看过滤器办法

在项目启动后通过debug能查看
1run.getBean(DefaultSecurityFilterChain.class)

认证流程

一直调用到UserDetailsService的实现类 InMemoryUserDetailsManager(这是个默认用内存中读取的对象以后换掉)
然后把查询到的用户信息封装成UserDetails。
如果认证成功那么人过滤器会把这个对象给存储到application也就是context中。
后 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2017/02/28/Spring/Spring%20Cloud%20Consul-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Cloud Consul-学习笔记">Spring Cloud Consul-学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-02-28T15:00:42.000Z" title="Created 2017-02-28 07:00:42">2017-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Consul/">Consul</a></span></div><div class="content">Spring Cloud微服务概念微服务组件示意图
核心问题
服务很多客户端怎么访问
这么多服务如何通信
如何治理
服务崩溃怎么解决

注册中心介绍介你麻痹
学习顺序
CAP原则

A 可用性、C 一致性、P 分布式

Availability 可用性

Partition-Tolerance 分区容错性

Consistency 一致性



CP 效率低（牺牲可用性）
AP 牺牲一致性 (有脏数据)
CA 牺牲横向可扩容 
对比
Consul 注册中心介绍
调用方式
特性
Raft 算法
https://www.cnblogs.com/xybaby/p/10124083.html
与Paxos不同raft 算法主要应用于工程界

服务发现

健康发现

Key/Value 存储

多数据中心

支持http和dns协议接口

官方提供web管理界面


角色
client: 客户端，无状态，将HTTP和DNS接口请求转发给局域网内的服务端集群
server: 服务端，保存配置信息，高可用集群，每个配置数据中心的server数量推荐为3个或五个。

模式
dev

cluster c ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2017/02/28/Spring/Spring%20Cloud%20Eureka-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Cloud Eureka-学习笔记">Spring Cloud Eureka-学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-02-28T15:00:42.000Z" title="Created 2017-02-28 07:00:42">2017-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Eureka/">Eureka</a></span></div><div class="content">Spring Cloud微服务概念微服务组件示意图
核心问题
服务很多客户端怎么访问
这么多服务如何通信
如何治理
服务崩溃怎么解决

注册中心介绍介你麻痹
学习顺序
CAP原则

A 可用性、C 一致性、P 分布式

Availability 可用性

Partition-Tolerance 分区容错性

Consistency 一致性



CP 效率低（牺牲可用性）
AP 牺牲一致性 (有脏数据)
CA 牺牲横向可扩容 
对比
Eureka架构原理



注册中心 Eureka Server
之间相互同步 Replicate


应用服务
注册 Registry
定时心跳机制 Renew
下线 Cancel
获取其他微服务信息 Get Registry


客户端服务 Client
Get Registry
Make Remote Call




角色

Server 注册中心
Service Provider 服务提供者
 注册、重新注册、清除 Register/Renew/Cancel


Servcie Consumer 服务消费者
负载均衡的调用 Remote Call ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2017/02/28/Spring/Spring%20Cloud%20Hystrix-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Cloud Hystrix">Spring Cloud Hystrix</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-02-28T15:00:42.000Z" title="Created 2017-02-28 07:00:42">2017-02-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Hystrix/">Hystrix</a></span></div><div class="content">Spring Cloud Hystrix介绍

Hystrix 解决服务不可用时的解决方案
雪崩: 某个服务导致的问题导致的其他服务链路整个不可用

什么是hystrixhystrix 是Netflix公司内部的服务容灾处理解决方案
雪崩效应
一个请求调用多个服务很常见。



某一个服务故障或者延迟会导致系统资源迅速耗尽或者系统出现不可信结果。
原因归结为三类:

服务提供不可用
重试导致的流量加大
服务消费者不可用


解决方案
请求缓存
将一个请求与放回结果做缓存处理

请求合并
将相同的请求合并然后用批处理接口；

服务隔离
限制调用分布式资源，某一个调用服务出现问题不会影响服务调用。

服务熔断
牺牲局部服务，保证全体系统稳定措施；

服务降级
服务熔断以后可以断调用自己本地方法返回缺省值；


问题对应方案mapping高并发场景:

请求缓存：

通过raids等技术通过缓存降低后续服务调用频率


请求合并：

比如查询多次不同的ID查询，可以合并为一次查询列表。


平凡调用查询商品列表导致查询ID等小资源消耗的服务响应缓慢

我们可以隔离微服务的资源。使用服务隔离
 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/38939292?s=60&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Akachi</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">52</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">28</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/akachi10"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/akachi10" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zsts@hotmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/29/English/%E8%AF%8D%E6%A0%B9%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E6%B3%95/" title="No title"><img src="https://raw.githubusercontent.com/akachi10/blog-pic/main/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="No title"/></a><div class="content"><a class="title" href="/2023/11/29/English/%E8%AF%8D%E6%A0%B9%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E6%B3%95/" title="No title">No title</a><time datetime="2023-11-29T08:35:41.954Z" title="Created 2023-11-29 00:35:41">2023-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/29/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9/%E8%AF%8D%E6%A0%B9%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E6%B3%95/" title="No title"><img src="https://raw.githubusercontent.com/akachi10/blog-pic/main/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="No title"/></a><div class="content"><a class="title" href="/2023/11/29/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9/%E8%AF%8D%E6%A0%B9%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E6%B3%95/" title="No title">No title</a><time datetime="2023-11-29T08:26:22.018Z" title="Created 2023-11-29 00:26:22">2023-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/01/C++/C++-%E5%9F%BA%E7%A1%80/" title="C++ 基础"><img src="https://raw.githubusercontent.com/akachi10/blog-pic/main/12.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C++ 基础"/></a><div class="content"><a class="title" href="/2023/03/01/C++/C++-%E5%9F%BA%E7%A1%80/" title="C++ 基础">C++ 基础</a><time datetime="2023-03-02T07:00:42.000Z" title="Created 2023-03-01 23:00:42">2023-03-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/12/%E8%A7%86%E9%A2%91%E6%96%87%E6%A1%88/%E7%BE%8E%E5%9B%BD%E8%80%83%E9%A9%BE%E7%85%A7%20DMV%E7%90%86%E8%AE%BA%E8%80%83%E8%AF%95%E6%8E%92%E5%9D%91%E6%8C%87%E5%8D%97/" title="美国游客办理驾照排坑指南"><img src="https://raw.githubusercontent.com/akachi10/blog-pic/main/13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="美国游客办理驾照排坑指南"/></a><div class="content"><a class="title" href="/2022/12/12/%E8%A7%86%E9%A2%91%E6%96%87%E6%A1%88/%E7%BE%8E%E5%9B%BD%E8%80%83%E9%A9%BE%E7%85%A7%20DMV%E7%90%86%E8%AE%BA%E8%80%83%E8%AF%95%E6%8E%92%E5%9D%91%E6%8C%87%E5%8D%97/" title="美国游客办理驾照排坑指南">美国游客办理驾照排坑指南</a><time datetime="2022-12-12T08:00:00.000Z" title="Created 2022-12-12 00:00:00">2022-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/06/%E6%B0%91%E8%BF%90%E6%97%A5%E8%AE%B0/%E6%B0%91%E8%BF%90%E6%97%A5%E8%AE%B0/" title="民运日记"><img src="https://raw.githubusercontent.com/akachi10/blog-pic/main/13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="民运日记"/></a><div class="content"><a class="title" href="/2022/12/06/%E6%B0%91%E8%BF%90%E6%97%A5%E8%AE%B0/%E6%B0%91%E8%BF%90%E6%97%A5%E8%AE%B0/" title="民运日记">民运日记</a><time datetime="2022-12-06T08:00:00.000Z" title="Created 2022-12-06 00:00:00">2022-12-06</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AI/"><span class="card-category-list-name">AI</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C/"><span class="card-category-list-name">C++</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Consul/"><span class="card-category-list-name">Consul</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Docker/"><span class="card-category-list-name">Docker</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Eureka/"><span class="card-category-list-name">Eureka</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Feign/"><span class="card-category-list-name">Feign</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Hystrix/"><span class="card-category-list-name">Hystrix</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Security/"><span class="card-category-list-name">Security</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 1.1em; color: #999">AI</a> <a href="/tags/AOP/" style="font-size: 1.1em; color: #999">AOP</a> <a href="/tags/Consul/" style="font-size: 1.1em; color: #999">Consul</a> <a href="/tags/DockerRegistry/" style="font-size: 1.1em; color: #999">DockerRegistry</a> <a href="/tags/Eureka/" style="font-size: 1.1em; color: #999">Eureka</a> <a href="/tags/Feign/" style="font-size: 1.18em; color: #999ca1">Feign</a> <a href="/tags/Gateway/" style="font-size: 1.1em; color: #999">Gateway</a> <a href="/tags/HA/" style="font-size: 1.1em; color: #999">HA</a> <a href="/tags/NN/" style="font-size: 1.1em; color: #999">NN</a> <a href="/tags/Nacos/" style="font-size: 1.1em; color: #999">Nacos</a> <a href="/tags/REST/" style="font-size: 1.1em; color: #999">REST</a> <a href="/tags/Sentinel/" style="font-size: 1.1em; color: #999">Sentinel</a> <a href="/tags/Sleuth/" style="font-size: 1.1em; color: #999">Sleuth</a> <a href="/tags/Spring/" style="font-size: 1.5em; color: #99a9bf">Spring</a> <a href="/tags/Spring-Cloud/" style="font-size: 1.42em; color: #99a6b7">Spring Cloud</a> <a href="/tags/Spring-Data/" style="font-size: 1.1em; color: #999">Spring Data</a> <a href="/tags/Web/" style="font-size: 1.1em; color: #999">Web</a> <a href="/tags/WordPress/" style="font-size: 1.1em; color: #999">WordPress</a> <a href="/tags/Zipkin/" style="font-size: 1.1em; color: #999">Zipkin</a> <a href="/tags/blog/" style="font-size: 1.18em; color: #999ca1">blog</a> <a href="/tags/ceph/" style="font-size: 1.1em; color: #999">ceph</a> <a href="/tags/docker/" style="font-size: 1.26em; color: #999fa8">docker</a> <a href="/tags/hexo/" style="font-size: 1.1em; color: #999">hexo</a> <a href="/tags/hugo/" style="font-size: 1.1em; color: #999">hugo</a> <a href="/tags/idea/" style="font-size: 1.1em; color: #999">idea</a> <a href="/tags/java/" style="font-size: 1.34em; color: #99a3b0">java</a> <a href="/tags/jvm/" style="font-size: 1.26em; color: #999fa8">jvm</a> <a href="/tags/mysql/" style="font-size: 1.1em; color: #999">mysql</a> <a href="/tags/spring/" style="font-size: 1.1em; color: #999">spring</a> <a href="/tags/swarm/" style="font-size: 1.18em; color: #999ca1">swarm</a> <a href="/tags/togaf/" style="font-size: 1.1em; color: #999">togaf</a> <a href="/tags/zuul/" style="font-size: 1.1em; color: #999">zuul</a> <a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 1.1em; color: #999">事务</a> <a href="/tags/%E4%BC%81%E4%B8%9A%E6%9E%B6%E6%9E%84/" style="font-size: 1.1em; color: #999">企业架构</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/" style="font-size: 1.1em; color: #999">分布式存储</a> <a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 1.1em; color: #999">单片机</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E5%9C%B0%E5%9B%BE/" style="font-size: 1.1em; color: #999">学习地图</a> <a href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/" style="font-size: 1.26em; color: #999fa8">容器化</a> <a href="/tags/%E5%AE%B9%E5%99%A8%E7%BC%96%E6%8E%92/" style="font-size: 1.1em; color: #999">容器编排</a> <a href="/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/" style="font-size: 1.1em; color: #999">对象存储</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span><a class="card-more-btn" href="/archives/" title="More">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">November 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">March 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">December 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">July 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">May 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">September 2021</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">August 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">July 2021</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">39</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-11-29T08:35:51.871Z"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://raw.githubusercontent.com/akachi10/blog-pic/main/1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Akachi</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://api.btstu.cn/yan/api.php?charset=utf-8&encode=json')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const sub = []
        sub.unshift(data.text)
        window.typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.text
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>